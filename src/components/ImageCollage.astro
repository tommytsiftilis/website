---
import { Image } from "astro:assets";

// Import all images from assets/collage
const images = import.meta.glob<{ default: ImageMetadata }>(
  "/src/assets/collage/*.{jpg,jpeg,png,gif,webp,avif,JPG,JPEG,PNG}",
  { eager: true }
);

// Sort by filename and extract image data
const sortedImages = Object.entries(images)
  .sort(([a], [b]) => a.localeCompare(b))
  .map(([_, module]) => module.default);

// Rotation values for variety
const rotations = [-3, 2, -1, 3, -2, 1];
---

<div class="collage-container">
  {sortedImages.map((src, index) => (
    <div
      class="collage-item"
      style={`--rotation: ${rotations[index % rotations.length]}deg`}
    >
      <Image
        src={src}
        alt={`About me ${index + 1}`}
        width={300}
        quality={80}
        loading="eager"
      />
    </div>
  ))}
</div>

<style>
  .collage-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    max-width: 550px;
    margin: 0 auto;
  }

  .collage-item {
    overflow: hidden;
    border-radius: 10px;
    transition: transform 0.3s ease;
    transform: rotate(var(--rotation, 0deg));
    aspect-ratio: 1;
  }

  .collage-item:hover {
    transform: rotate(var(--rotation, 0deg)) scale(1.03);
    z-index: 1;
  }

  .collage-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /* Responsive - 2 columns on mobile */
  @media (max-width: 450px) {
    .collage-container {
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }
  }
</style>
